# NYC Hiring Audit Project Report

## 1. Pipeline Architecture and Data Flow

The pipeline ingests raw NY job postings, processes and cleans the data, applies fuzzy matching to payroll and Lightcast occupation datasets, and outputs gold tables for analysis.

- **Data Sources**: API ingestion from two different links, and Lightcast occupation datasets that was in an excel file
- **Processing Steps**: 
1. Read and filter job postings for 2024/2025
2. Calculate posting duration (using Post Until or default of 30 days)
3. Apply fuzzy string matching to business titles
4. Generate gold tables in DuckDB for dashboarding

-**Tools**: Python(pandas, rapidfuzz), dbt, Airflow, DuckDB, Metabase

## 2. Final DuckDB Schema
### nyc_job_postings_gold
- job_id (VARCHAR)
- business_title (VARCHAR)
- agency (VARCHAR)
- posting_date (TIMESTAMP)
- post_until (TIMESTAMP)
- posting_duration_days (BIGINT)
- salary_range_from (DOUBLE)
- salary_range_to (DOUBLE)
- Payroll Fuzzy Match (VARCHAR)
- Payroll Salary Annual (DOUBLE)
- Match Ratio (DOUBLE)

### nyc_posting_duration_gold_occupations
- job_id (VARCHAR)
- business_title (VARCHAR)
- agency (VARCHAR)
- posting_date (TIMESTAMP)
- post_until (TIMESTAMP)
- posting_duration_days (BIGINT)
- lightcast_top_posted_occupations_silver_match_title (VARCHAR)
- lightcast_top_posted_occupations_silver_match_ratio (DOUBLE)

### nyc_posting_duration_gold_occupations_soc
- job_id (VARCHAR)
- business_title (VARCHAR)
- agency (VARCHAR)
- posting_date (TIMESTAMP)
- post_until (TIMESTAMP)
- posting_duration_days (BIGINT)
- lightcast_top_posted_occupations_soc_silver_match_title (VARCHAR)
- lightcast_top_posted_occupations_soc_silver_match_ratio (DOUBLE)

### nyc_posting_duration_gold_occupations_onet
- job_id (VARCHAR)
- business_title (VARCHAR)
- agency (VARCHAR)
- posting_date (TIMESTAMP)
- post_until (TIMESTAMP)
- posting_duration_days (BIGINT)
- lightcast_top_posted_occupations_onet_silver_match_title (VARCHAR)
- lightcast_top_posted_occupations_onet_silver_match_ratio (DOUBLE)

### nyc_posting_duration_gold_job_titles
- job_id (VARCHAR)
- business_title (VARCHAR)
- agency (VARCHAR)
- posting_date (TIMESTAMP)
- post_until (TIMESTAMP)
- posting_duration_days (BIGINT)
- lightcast_top_posted_job_titles_silver_match_title (VARCHAR)
- lightcast_top_posted_job_titles_silver_match_ratio (DOUBLE)

## 3. Fuzzy String Matching
- **Library Used**: rapidfuzz
- **Comparison Strings**: Generated by concatenating agency and business title, or by using occupation titles from lookup tables
- **Match Ratio**: Measures similarity between job posting title and lookup string (0-100)
- **Thresholds**: 
1. Payroll match: >= 85%
2. Lightcast occupation match: >= 75%
- **Why rapidfuzz**: I picked it over The Fuzz due to its speed and efficiency with larger datasets

## 4. Posting Date Filtering
- Only job postings with posting_data in 2024 or 2025 were included
- Used pandas to parse and filter dates, ensuring consistency for data analysis

## 5. Key Challenges and Prioritization
- **Time Constraints**: 5 days to deliver a working pipeline and dashboard
- **Challenges**: 
1. Handling non-standard date formats
2. Getting the fuzzy match logic figured out
3. Hooking Metabase and DuckDB. 
4. Sick day/vacation day


